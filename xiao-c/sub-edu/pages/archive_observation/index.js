"use strict";require("../../app"),(wx["subeduWebpackJsonp"]=wx["subeduWebpackJsonp"]||[]).push([[942],{5394:function(e,t,o){var n=o(6619),i=o(1905),l=o(2903),u=o(1949),a=o(2489),r=o(6978),v=o(1479),d=o(9800),s=o(487),c=o(2090),b=o(7463),p=o.n(b),f=o(4275),I=o(5404),h=["studentId"],m={selectStudent:[],observeSituation:[],sectorValue:[],observeTime:"",showParentVisible:!1,parentVisible:!1,observeContent:"",observeAnalysis:"",observeFollow:"",observePhoto:{},uniqueId:"",observeId:"",correlateId:""},g=function(){var e=(0,b.useRouter)(),t=(0,s._)(m),o=(0,r.Z)(t,2),n=o[0],g=o[1],Z=n||{},w=Z.uniqueId,x=Z.observeId,y=Z.correlateId;(0,v.useEffect)((function(){var e,t,o,n,i,l,r=(0,d.R0)(-1),v=null===r||void 0===r||null===(e=r.data)||void 0===e?void 0:e.uniqueId,s=null===r||void 0===r||null===(t=r.data)||void 0===t?void 0:t.observationdetail;console.log("\ud83d\ude80\ud83d\ude80\ud83d\ude80\ud83d\ude80\ud83d\ude80\ud83d\ude80  observationdetail:",s);var c=s||{},b=c.content,f=c.student,I=c.extractInfo,m=c.observeId,Z=c.correlateId;null===p()||void 0===p()||null===(o=p().setNavigationBarTitle)||void 0===o||o.call(p(),{title:m?"\u7f16\u8f91\u5f52\u6863\u8bb0\u5f55":"\u5f52\u6863\u89c2\u5bdf\u8bb0\u5f55"});var w=null===b||void 0===b?void 0:b.split("## \u8ddf\u8fdb\u63aa\u65bd\uff1a"),x=null===w||void 0===w?void 0:w[0].replace("## \u89c2\u5bdf\u5206\u6790\uff1a",""),y=null===w||void 0===w?void 0:w[1],N=I||{},T=N.situationList,q=N.date,P=N.sectorList,V=N.input,k=N.photo,A=N.behavior,C=(null===P||void 0===P||null===(n=P.map((function(e){var t=e.sub;return t})))||void 0===n?void 0:n.flat(2))||[],S=null!==T&&void 0!==T&&null!==(i=T[0])&&void 0!==i&&i.situationId||null!==T&&void 0!==T&&null!==(l=T[0])&&void 0!==l&&l.situationName?null===T||void 0===T?void 0:T.map((function(e){return null===e||void 0===e?void 0:e.situationId})):T||[],j=null===f||void 0===f?void 0:f.map((function(e){var t,o=e.studentId,n=(0,a.Z)(e,h);return(0,u.Z)((0,u.Z)({},n),{},{studentId:o,data:null===A||void 0===A||null===(t=A.find((function(e){return(null===e||void 0===e?void 0:e.studentId)===o})))||void 0===t||null===(t=t.sectorList)||void 0===t?void 0:t.reduce((function(e,t){var o,n=t||{},i=n.area,l=n.sub,u=n.chosen,a=null===e||void 0===e?void 0:e.findIndex((function(e){return(null===e||void 0===e?void 0:e.typeName)===i}));(a=a||0===a?a:-1,-1===a)?null===e||void 0===e||e.push({typeName:i,data:[{label:l,data:null===u||void 0===u?void 0:u.map((function(e){var t=e.title,o=e.level;return{label:t,level:Number((null===o||void 0===o?void 0:o.replaceAll("L",""))||"")}}))}]}):null===e||void 0===e||null===(o=e[a])||void 0===o||null===(o=o.data)||void 0===o||o.push({label:l,data:null===u||void 0===u?void 0:u.map((function(e){var t=e.title,o=e.level;return{label:t,level:Number((null===o||void 0===o?void 0:o.replaceAll("L",""))||"")}}))});return e}),[])})}));g("state",{selectStudent:j,observeAnalysis:x,observeFollow:y,observeSituation:S,observeTime:q,sectorValue:C,observeContent:V,observePhoto:k,uniqueId:v,correlateId:Z,observeId:m}),L()}),[]);var L=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(){var t,o,n,l;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,f["do"])();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:t=e.t0,o=t||{},n=o.status,l=o.flag,g("state",{parentVisible:1===l,showParentVisible:0===n});case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var t=(0,l.Z)((0,i.Z)().mark((function t(o){var n,l,a,r,v,s,c,b,I,h,m,g,Z,L,N;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log("\ud83d\ude80\ud83d\ude80\ud83d\ude80\ud83d\ude80\ud83d\ude80\ud83d\ude80  values:",o),r=o||{},v=r.observeContent,s=r.observeTime,c=r.situationList,b=r.studentList,I=r.observeAnalysis,h=r.observeFollow,m=r.parentVisible,g=r.sectorList,Z=r.observePhoto,L=(0,u.Z)((0,u.Z)({content:v,observeDate:s,sectorName:null===g||void 0===g||null===(n=g.map((function(e){return null===e||void 0===e?void 0:e.label})))||void 0===n?void 0:n.join(","),situationName:null===c||void 0===c||null===(l=c.map((function(e){return null===e||void 0===e?void 0:e.label})))||void 0===l?void 0:l.join(","),studentList:JSON.stringify(b),correlateId:y||(null===(a=e.params)||void 0===a?void 0:a.correlateId),analysis:I},Z||{}),{},{observeId:x,cure:h,source:1,flag:m?1:0}),console.log("\ud83d\ude80\ud83d\ude80\ud83d\ude80\ud83d\ude80\ud83d\ude80\ud83d\ude80  opts:",L),N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;p().hideToast(),p().showToast({title:2===e?"\u4fdd\u5b58\u6210\u529f":"\u5f52\u6863\u6210\u529f",icon:"none"}),setTimeout((function(){var e;p().navigateBack({delta:1});var t=(0,d.R0)(-1),o=null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.uniqueId;null===t||void 0===t||t.setData({from:"archive_observation",uniqueId:o})}),1e3)},(0,f.zZ)(L).then((function(e){e&&(x?N(2):(0,f.$C)({dataId:w,tag:"\u5df2\u5f52\u6863"}).then(N))}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,I.jsx)(c.Xy,(0,u.Z)((0,u.Z)({},n),{},{type:"observe",submit:N,isEdit:!!x}))},Z=g,w={navigationBarTitleText:"\u5f52\u6863\u89c2\u5bdf\u8bb0\u5f55"};Page((0,n.createPageConfig)(Z,"pages/archive_observation/index",{root:{cn:[]}},w||{}))}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[107,216,592],(function(){return t(5394)}));e.O()}]);